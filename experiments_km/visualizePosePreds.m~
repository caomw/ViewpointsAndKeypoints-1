% We're interested only in the 'car' class
class = 'car';

% Load pose prediction features, if they don't already exist
if ~exist('feat', 'var')
    load(fullfile(cachedir, 'rcnnPredsVps', 'vggJointVps', class), 'feat');
end
% The variable 'feat' now contains pose features.

% Load train/test data, if not already loaded
if ~exist('data', 'var')
    data = load(fullfile(cachedir,'evalSets',class));
end

% Generate evaluation sets from the data loaded above
[trainLabels,testLabels,trainFeats,testFeats] = generateEvalSetData(data);

% Predict poses on test set (alpha is the weight parameter, used to weight
% coarse and fine pose features; nHypotheses is the number of hypotheses to
% consider while predicting pose)
alphaOpt = params.alpha;
nHypotheses = params.nHypotheses;
testPreds = poseHypotheses(testFeats, nHypotheses, alphaOpt);
% Since we consider only one hypothesis, load it
testPreds = testPreds{1};


% Generate a sample of 1 image to test the visualizeRotations function

% Index of the current image we're considering
curIdx = 1;

% Ground truth for the current instance
gt = testLabels(curIdx,:);
% Prediction for the current instance
prediction = testPreds(curIdx,:);
% Data struct for the current instance
dataStruct_temp.voc_ids{1} = data.test.voc_ids{curIdx};
dataStruct_temp.bbox(1) = data.test.bboxes(curIdx,:);


